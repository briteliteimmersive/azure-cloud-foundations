{
    "name": "az-056-enforce-general-resources-allowed-resourcetypes",
    "type": "Microsoft.Authorization/policyDefinitions",
    "apiVersion": "2021-06-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "mode": "All",
        "displayName": "az-056-enforce-general-resources-allowed-resourcetypes",
        "description": "(az-056) : This policy ensures only approved resource types are deployed",
        "metadata": {
            "version": "2.0.0",
            "category": "General"
        },
        "parameters": {
            "listOfResourceTypesAllowed": {
                "allowedValues": [
                    "Microsoft.ApiManagement/*",
                    "Microsoft.DataMigration/*",
                    "Microsoft.Devices/*",
                    "Microsoft.DevSpaces/*",
                    "Microsoft.IoTCentral/*",
                    "Microsoft.Kusto/*",
                    "Microsoft.MachineLearning/*",
                    "Microsoft.Maps/*",
                    "Microsoft.Notebooks/*",
                    "Microsoft.StreamAnalytics/*",
                    "Microsoft.VSOnline/*",
                    "Sendgrid.Email/*",
                    "Microsoft.AAD/*",
                    "microsoft.aadiam/*",
                    "Microsoft.Advisor/*",
                    "Microsoft.AlertsManagement/*",
                    "Microsoft.AnalysisServices/*",
                    "Microsoft.AppConfiguration/*",
                    "Microsoft.Authorization/*",
                    "Microsoft.Automation/*",
                    "Microsoft.Batch/*",
                    "Microsoft.BatchAI/*",
                    "Microsoft.Billing/*",
                    "Microsoft.BotService/*",
                    "Microsoft.Cache/*",
                    "Microsoft.Cdn/*",
                    "Microsoft.CognitiveServices/*",
                    "Microsoft.Compute/*",
                    "Microsoft.Consumption/*",
                    "Microsoft.ContainerInstance/*",
                    "Microsoft.ContainerRegistry/*",
                    "Microsoft.ContainerService/*",
                    "Microsoft.CostManagement/*",
                    "Microsoft.Databricks/*",
                    "Microsoft.DataFactory/*",
                    "Microsoft.DataLakeStore/*",
                    "Microsoft.DataShare/*",
                    "Microsoft.DBforMariaDB/*",
                    "Microsoft.DBforMySQL/*",
                    "Microsoft.DBforPostgreSQL/*",
                    "Microsoft.Devices/IotHubs/*",
                    "Microsoft.DevTestLab/*",
                    "Microsoft.DocumentDB/*",
                    "Microsoft.EventGrid/*",
                    "Microsoft.EventHub/*",
                    "Microsoft.GuestConfiguration/*",
                    "Microsoft.HDInsight/*",
                    "Microsoft.HealthcareApis/*",
                    "microsoft.insights/*",
                    "Microsoft.KeyVault/*",
                    "Microsoft.Kubernetes/*",
                    "Microsoft.LogAnalytics/*",
                    "Microsoft.Logic/*",
                    "Microsoft.MachineLearningServices/*",
                    "Microsoft.ManagedIdentity/*",
                    "Microsoft.Migrate/*",
                    "Microsoft.Network/*",
                    "Microsoft.Network/applicationGateways*",
                    "Microsoft.NotificationHubs/*",
                    "Microsoft.OperationalInsights/*",
                    "Microsoft.OperationsManagement/*",
                    "Microsoft.PolicyInsights/*",
                    "Microsoft.Portal/*",
                    "Microsoft.PowerBI/*",
                    "Microsoft.PowerBIDedicated/*",
                    "Microsoft.RecoveryServices/*",
                    "Microsoft.Relay/*",
                    "Microsoft.ResourceGraph/*",
                    "Microsoft.ResourceHealth/*",
                    "Microsoft.Resources/*",
                    "Microsoft.Search/*",
                    "Microsoft.Security/*",
                    "Microsoft.SecurityGraph/*",
                    "Microsoft.ServiceBus/*",
                    "Microsoft.SignalRService/*",
                    "Microsoft.Sql/*",
                    "Microsoft.SqlVirtualMachine/*",
                    "Microsoft.Storage/*",
                    "Microsoft.StorageSync/*",
                    "Microsoft.Subscription/*",
                    "microsoft.support/*",
                    "Microsoft.Synapse/*",
                    "microsoft.visualstudio/*",
                    "Microsoft.Web/*"
                ],
                "defaultValue": [
                    "Microsoft.ApiManagement/*",
                    "Microsoft.DataMigration/*",
                    "Microsoft.Devices/*",
                    "Microsoft.DevSpaces/*",
                    "Microsoft.IoTCentral/*",
                    "Microsoft.Kusto/*",
                    "Microsoft.MachineLearning/*",
                    "Microsoft.Maps/*",
                    "Microsoft.Notebooks/*",
                    "Microsoft.StreamAnalytics/*",
                    "Microsoft.VSOnline/*",
                    "Sendgrid.Email/*",
                    "Microsoft.AAD/*",
                    "microsoft.aadiam/*",
                    "Microsoft.Advisor/*",
                    "Microsoft.AlertsManagement/*",
                    "Microsoft.AnalysisServices/*",
                    "Microsoft.AppConfiguration/*",
                    "Microsoft.Authorization/*",
                    "Microsoft.Automation/*",
                    "Microsoft.Batch/*",
                    "Microsoft.BatchAI/*",
                    "Microsoft.Billing/*",
                    "Microsoft.BotService/*",
                    "Microsoft.Cache/*",
                    "Microsoft.Cdn/*",
                    "Microsoft.CognitiveServices/*",
                    "Microsoft.Compute/*",
                    "Microsoft.Consumption/*",
                    "Microsoft.ContainerInstance/*",
                    "Microsoft.ContainerRegistry/*",
                    "Microsoft.ContainerService/*",
                    "Microsoft.CostManagement/*",
                    "Microsoft.Databricks/*",
                    "Microsoft.DataFactory/*",
                    "Microsoft.DataLakeStore/*",
                    "Microsoft.DataShare/*",
                    "Microsoft.DBforMariaDB/*",
                    "Microsoft.DBforMySQL/*",
                    "Microsoft.DBforPostgreSQL/*",
                    "Microsoft.Devices/IotHubs/*",
                    "Microsoft.DevTestLab/*",
                    "Microsoft.DocumentDB/*",
                    "Microsoft.EventGrid/*",
                    "Microsoft.EventHub/*",
                    "Microsoft.GuestConfiguration/*",
                    "Microsoft.HDInsight/*",
                    "Microsoft.HealthcareApis/*",
                    "microsoft.insights/*",
                    "Microsoft.KeyVault/*",
                    "Microsoft.Kubernetes/*",
                    "Microsoft.LogAnalytics/*",
                    "Microsoft.Logic/*",
                    "Microsoft.MachineLearningServices/*",
                    "Microsoft.ManagedIdentity/*",
                    "Microsoft.Migrate/*",
                    "Microsoft.Network/*",
                    "Microsoft.Network/applicationGateways*",
                    "Microsoft.NotificationHubs/*",
                    "Microsoft.OperationalInsights/*",
                    "Microsoft.OperationsManagement/*",
                    "Microsoft.PolicyInsights/*",
                    "Microsoft.Portal/*",
                    "Microsoft.PowerBI/*",
                    "Microsoft.PowerBIDedicated/*",
                    "Microsoft.RecoveryServices/*",
                    "Microsoft.Relay/*",
                    "Microsoft.ResourceGraph/*",
                    "Microsoft.ResourceHealth/*",
                    "Microsoft.Resources/*",
                    "Microsoft.Search/*",
                    "Microsoft.Security/*",
                    "Microsoft.SecurityGraph/*",
                    "Microsoft.ServiceBus/*",
                    "Microsoft.SignalRService/*",
                    "Microsoft.Sql/*",
                    "Microsoft.SqlVirtualMachine/*",
                    "Microsoft.Storage/*",
                    "Microsoft.StorageSync/*",
                    "Microsoft.Subscription/*",
                    "microsoft.support/*",
                    "Microsoft.Synapse/*",
                    "microsoft.visualstudio/*",
                    "Microsoft.Web/*"
                ],
                "type": "Array",
                "metadata": {
                  "description": "The list of resource types that can be deployed.",
                  "displayName": "Allowed resource types",
                  "strongType": "resourceTypes"
                }
              },
              "effect": {
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny",
                "metadata": {

                    "description": "Enable or disable the execution of the policy",
                    "displayName": "Effect"
                },
                "type": "String"
              }
        },
        "policyRule": {
            "if": {
              "not": {
                "field": "type",
                "in": "[parameters('listOfResourceTypesAllowed')]"
              }
            },
            "then": {
              "effect": "[parameters('effect')]"
            }
          }
    }
}