{
    "assignableScopes": ["${current_scope_resource_id}"],
    "description": "Hardened SQL Server contributor, with no access to FW rules. Scoped to root MG.",
    "name": "4db27985-a68b-4b58-8bfe-e466813a76a3",
    "permissions": [
      {
        "actions": [
          "Microsoft.Authorization/*/read",
          "Microsoft.Sql/servers/firewallRules/read/*",
          "Microsoft.Insights/alertRules/*",
          "Microsoft.ResourceHealth/availabilityStatuses/read",
          "Microsoft.Resources/deployments/*",
          "Microsoft.Resources/subscriptions/resourceGroups/read",
          "Microsoft.Sql/locations/*/read",
          "Microsoft.Sql/servers/*",
          "Microsoft.Sql/servers/elasticPools/*",
          "Microsoft.Support/*",
          "Microsoft.Insights/metrics/read",
          "Microsoft.Sql/servers/extendedAuditingSettings/read",
          "Microsoft.Sql/servers/databases/dataMaskingPolicies/rules/*",
          "Microsoft.Sql/managedInstances/databases/transparentDataEncryption/read",
          "Microsoft.Insights/alertRules/delete",
          "Microsoft.Insights/metricDefinitions/read",
          "Microsoft.Sql/servers/elasticPools/*",
          "Microsoft.Resources/tags/read"
        ],
        "dataActions": [],
        "notActions": [
          "Microsoft.Sql/managedInstances/databases/currentSensitivityLabels/*",
          "Microsoft.Sql/servers/firewallRules/write/*",
          "Microsoft.Sql/servers/firewallRules/delete/*",
          "Microsoft.Sql/locations/firewallRulesAzureAsyncOperation/read/*",
          "Microsoft.Sql/servers/virtualNetworkRules/delete/*",
          "Microsoft.Sql/servers/virtualNetworkRules/write/*",
          "Microsoft.Sql/managedInstances/databases/recommendedSensitivityLabels/*",
          "Microsoft.Sql/managedInstances/databases/schemas/tables/columns/sensitivityLabels/*",
          "Microsoft.Sql/managedInstances/databases/securityAlertPolicies/*",
          "Microsoft.Sql/managedInstances/databases/sensitivityLabels/*",
          "Microsoft.Sql/managedInstances/databases/vulnerabilityAssessments/*",
          "Microsoft.Sql/managedInstances/securityAlertPolicies/*",
          "Microsoft.Sql/managedInstances/vulnerabilityAssessments/*",
          "Microsoft.Sql/servers/auditingSettings/write",
          "Microsoft.Sql/servers/databases/auditingSettings/*",
          "Microsoft.Sql/servers/databases/auditRecords/read",
          "Microsoft.Sql/servers/databases/currentSensitivityLabels/*",
          "Microsoft.Sql/servers/databases/extendedAuditingSettings/*",
          "Microsoft.Sql/servers/databases/recommendedSensitivityLabels/*",
          "Microsoft.Sql/servers/databases/schemas/tables/columns/sensitivityLabels/*",
          "Microsoft.Sql/servers/databases/securityAlertPolicies/*",
          "Microsoft.Sql/servers/databases/securityMetrics/*",
          "Microsoft.Sql/servers/databases/sensitivityLabels/*",
          "Microsoft.Sql/servers/databases/vulnerabilityAssessments/*",
          "Microsoft.Sql/servers/databases/vulnerabilityAssessmentScans/*",
          "Microsoft.Sql/servers/databases/vulnerabilityAssessmentSettings/*",
          "Microsoft.Sql/servers/extendedAuditingSettings/*",
          "Microsoft.Sql/servers/securityAlertPolicies/*",
          "Microsoft.Resources/tags/write",
          "Microsoft.Resources/tags/delete",
          "Microsoft.Sql/servers/extendedAuditingSettings/write",
          "Microsoft.Sql/servers/privateEndpointConnections/delete",
          "Microsoft.Sql/servers/privateEndpointConnections/write",
          "Microsoft.Insights/alertRules/write",
          "Microsoft.Insights/alertRules/delete",
          "Microsoft.Sql/servers/vulnerabilityAssessments/*"
        ],
        "notDataActions": []
      }
    ],
    "roleName": "SQL Admin",
    "roleType": "CustomRole",
    "type": "Microsoft.Authorization/roleDefinitions"
  }